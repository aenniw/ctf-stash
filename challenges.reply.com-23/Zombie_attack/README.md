#### Challenge:

As the battle begins, R-Boy quickly realizes that Nethra is an opponent unlike any other. The AI anticipates every move he makes, making it nearly impossible to gain the upper hand. For a moment, R-Boy feels overwhelmed, at the mercy of an enemy that seems indestructible. However, R-Boy receives a signal from his team, revealing a well-thought-out strategy from a previous attack. `-ZoMb134tTack-`` [misc-200.zip](./misc-200.zip ":ignore")

---

#### Solution:

- inspecting the `pcap` messages `tcp.len > 0` reveals some sketchy communication and one `json` that seem to be generated by the provided `exe`
```json
{
    "iv": "ddromu4CFhvHG+HE70Bbvw==",
    "ciphertext": "ER0V1ge5/0jIeBNo5FMELTuszfOVgf/cjSrFbsMlCFOEZFQMKVZfGpQLHvtPIXmcSoM7ahskjgPcBvvc/4TxmQujF48RiSm2kNqaUuQn3+8UdY5/zYoXUglkddVfUfLedSh0F8H6/093dICMojjUTzgnCbztrzdwCUW2pFUpb5y4XVFzKa5AJG6KEMTwsArKZBQ2i3cHTpsby6Jwzm45WkTF+Ns/NK3kISBNiNhSYOHkmSTxi56eRpTCPp6fTy5MDHduOdao+r8csrr5QOwWWaMulDdUmC42zBY1ysmNXaA="
}
```
- inspection of the `exe` with string shows a ton of `python` related files thus most probably it's been generated with `py2exe` that could be reversed
```bash
git clone git@github.com:extremecoders-re/pyinstxtractor.git
python ./pyinstxtractor.py zombie05.exe 
decompyle3 ./zombie05\ \(3\).pyc 
```

- adjusting the decompiled code with `decrypt` counterpart function reveals the flag
```python
from Crypto.Cipher import AES
from base64 import b64encode, b64decode
from Crypto.Util.Padding import pad
from time import sleep
import json


msg = {
    "iv": "ddromu4CFhvHG+HE70Bbvw==",
    "ciphertext": "ER0V1ge5/0jIeBNo5FMELTuszfOVgf/cjSrFbsMlCFOEZFQMKVZfGpQLHvtPIXmcSoM7ahskjgPcBvvc/4TxmQujF48RiSm2kNqaUuQn3+8UdY5/zYoXUglkddVfUfLedSh0F8H6/093dICMojjUTzgnCbztrzdwCUW2pFUpb5y4XVFzKa5AJG6KEMTwsArKZBQ2i3cHTpsby6Jwzm45WkTF+Ns/NK3kISBNiNhSYOHkmSTxi56eRpTCPp6fTy5MDHduOdao+r8csrr5QOwWWaMulDdUmC42zBY1ysmNXaA="
}
KEY = 'Keypitsimple! <3'
ENTROPY = 'Operations time:D'


def generate_pass(psw):
    char_list = [psw[i] if i not in (
        2, 6, 10, 14) else psw[i + 4 if i < 14 else 2] for i in range(len(psw))]
    new_string = ''.join(char_list)
    a_list = [chr(ord(a) ^ ord(b)) for a, b in zip(new_string, ENTROPY)]
    key = ''.join(a_list)
    return key


def decrypt(key):
    iv = b64decode(msg['iv'])
    cipher = AES.new(key, AES.MODE_CBC, iv)
    return cipher.decrypt(b64decode(msg['ciphertext']))


privkey = generate_pass(KEY)
print(decrypt(bytes(privkey, 'utf-8')))
```

---

<details><summary>FLAG:</summary>

```
{FLG:Th1s_1s_th3_f1n4l_z0mb13_s3cr3t!}
```

</details>
