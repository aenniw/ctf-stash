#### Challenge:

I've intercepted multiple copies of an encrypted message from the leader
of the Worcester chapter of the Illuminati. I think it contains the time of
their next meeting. Can you help me decrypt them?

made by: acurless

c1=`594910348838654930124903312657182894692402342855962311691745910670968953979763398268178356759480252574145802212846778456498151882777298349344823533898569929083456935739170780414186363917570866953295266482619988090991739704837557510047552991540192416596394939878512971068128346460135181633837691607887585595327377592504025910932886174012575455063092216526235150042218367596522000836855265060061907805179368494125670233900165640419188489720300699481801554542708984234714309304304680798812784115514135495157698670614237399893699767578125`

c2=`594910348838654930124903312657182894692402342855962311691745910670968953979763398268178356759480252574145802212846778456498151882777298349344823533898569929083456935739170780414186363917570866953295266482619988090991739704837557510047552991540192416596394939878512971068128346460135181633837691607887585595327377592504025910932886174012575455063092216526235150042218367596522000836855265060061907805179368494125670233900165640419188489720300699481801554542708984234714309304304680798812784115514135495157698670614237399893699767578125`

c3=`594910348838654930124903312657182894692402342855962311691745910670968953979763398268178356759480252574145802212846778456498151882777298349344823533898569929083456935739170780414186363917570866953295266482619988090991739704837557510047552991540192416596394939878512971068128346460135181633837691607887585595327377592504025910932886174012575455063092216526235150042218367596522000836855265060061907805179368494125670233900165640419188489720300699481801554542708984234714309304304680798812784115514135495157698670614237399893699767578125`


n1=`21939147590581954242131893557689750173730181114330873782062274456630281986233643990882568426690149971468987847436717513764939861105600249325682418749886588739440853385485272501856860578476795830603738468829294920737586209822299603185425324611481798231193950636987017718955070420091525231666894903436050998112803225822333684113551754209802262129292376015861410644289380376439390552627189657966103965089679163295591136464541998227543058082734503570960156783196006833967361311083486266118899788620317372054292861892020849652213277431575285275801196626852675579752895079650118836892859390462805733596279690076656763624249`

n2=`26325215018784165663958487526715385161171636566916698114816183716597566424675870012796860473421390775180027083457908584461525282815469520282303059318923930531826588673345113634118988713179894971211405380241575065877886390347877768297280022387015195069836149198306647472534681286406136303674462323742151285361538383784282113898065157278366533587767199303585208673225974716800760227497569577072903884939422787710986913747191378087554442395968729847569180921093186599977266346501947184849099856506537976370069200813758143237937721729073822639191799709052936074831322440705620902220824412476988222346922869104007199777561`

n3=`23013589835547680503802140462487647716102548445081685245087901486321520435018899614072711065158868927754813316329675676910885474767916372370942795565358071859270832973837949423193707764788999822539648518439967218163608118921979697363190728350735745938069012584523314223346479156208977445194408267152808800890485882602068876756801123087623323707553203656108124651989136578687688847505350883163751096338640206246619001851586459510648241545637475283654557530338836698680934504086346810521919864048046078444168117563048636886066060497385368685340990757248020960409380316695810483273153565980791846594355984630591111120973`


e=`3`

---

#### Solution:

We have three different (presumably RSA) cryptexts `c1, c2, c3` of the same plaintext message `m` and all of them use same exponent `e=3`. If they actually are RSA encrypted then they were created using following formulas:

```
c1 = m^3 mod n1
c2 = m^3 mod n2
c3 = m^3 mod n3
```

so we want to get the plaintext message `m`. This can be achieved by solving following system of equations using  `Chinese Remainder Theorem (CRT)`:

```
m^3 = c1 mod n1
m^3 = c2 mod n2
m^3 = c3 mod n3
```

What makes this possible is knowing `m` is a positive integer less than each of the `n`s, and that `m^3 < n1*n2*n3`. It follows that we can simply take the cube root in the integers and not the cube root in modular arithmetic. 

The resulting plaintext message was encoded in decimal ASCII and contained the flag. 

```python
#!/env python3

### Solution based on:
# https://www.johndcook.com/blog/2019/03/06/rsa-exponent-3/

## Digits to text taken from:
#  https://stackoverflow.com/questions/34085917/error-i-cant-fix-while-converting-text-to-number-in-rsa-algorithm-using-python

from secrets import randbits, randbelow
from sympy import nextprime
from sympy.ntheory.modular import crt
from Crypto.Util.number import long_to_bytes

import gmpy2


N = []
N.append(21939147590581954242131893557689750173730181114330873782062274456630281986233643990882568426690149971468987847436717513764939861105600249325682418749886588739440853385485272501856860578476795830603738468829294920737586209822299603185425324611481798231193950636987017718955070420091525231666894903436050998112803225822333684113551754209802262129292376015861410644289380376439390552627189657966103965089679163295591136464541998227543058082734503570960156783196006833967361311083486266118899788620317372054292861892020849652213277431575285275801196626852675579752895079650118836892859390462805733596279690076656763624249)
N.append(26325215018784165663958487526715385161171636566916698114816183716597566424675870012796860473421390775180027083457908584461525282815469520282303059318923930531826588673345113634118988713179894971211405380241575065877886390347877768297280022387015195069836149198306647472534681286406136303674462323742151285361538383784282113898065157278366533587767199303585208673225974716800760227497569577072903884939422787710986913747191378087554442395968729847569180921093186599977266346501947184849099856506537976370069200813758143237937721729073822639191799709052936074831322440705620902220824412476988222346922869104007199777561)
N.append(23013589835547680503802140462487647716102548445081685245087901486321520435018899614072711065158868927754813316329675676910885474767916372370942795565358071859270832973837949423193707764788999822539648518439967218163608118921979697363190728350735745938069012584523314223346479156208977445194408267152808800890485882602068876756801123087623323707553203656108124651989136578687688847505350883163751096338640206246619001851586459510648241545637475283654557530338836698680934504086346810521919864048046078444168117563048636886066060497385368685340990757248020960409380316695810483273153565980791846594355984630591111120973)

c = []
c.append(515274042976912179894435774656907420040599503456517078488056218986662017260212389975972477279505310799399071383390618892499008790928347543017765027618590150794317674792875250152206518326158674718404382617692169589911938548819188733852354294583496715425255584973283840789780326402769751705164900106921523637157271605500111846563844641773661723255718653040958019618435501230171699432186518803652675691180548548982155426472648502704469425298466513665043628724497448475714424482446137414939511691724839553567514050622159418495196773388690852258256550787962177196383253952227153557220272199293397879908308572668952866439)
c.append(10512934566887371506285681495672139256544177416158977932082410009242386741198073874632763611137937701329570263046854521709347241390006612379393018933295475369159148328248445221357906382527678877429535168220389698475391828837227453358681276167720605617228338487308750653165147019400915842904872988789759529121710032871148507314874152494680057046977274373381326003405301191489108322498519602528688873942243307708631394538177629868515911161222795303220989599519719169300455717641863368473309673489958952173445661451265442004625237606054046962062434813126456494957846077185121041599277143211160596207640833275850170891378)
c.append(4122591425712279559823043898131225014447235394996958162806737555257607173149332839353292933732548212376056402900761362427837044396517072345683265668973735260384169928448531246071624967168190024583028639591981238222340513125989229227761894026521238496145716707176637113415430809586007230597253976748507442809040629281971868442704017013258355403718545489677897799000961350863824810217217745918503635905775610161826572608564207497464646323778407843991683950506484189720225535503643332574132841288909783555334280205740975729691459011043954137669831817945210956835398278009161994675851980163314376477384045294293755909874)

x = crt(N, c)

print(str(gmpy2.iroot_rem(x[0],3)[0]))

def Num2Ascii(message):
    Ascii = ""
    char = ""
    message = str(message)
    if len(message)%3 == 0:
        for count in range(len(message)):
            if (count+1)%3 == 0:
                char = char + message[count]
                Ascii = Ascii + char + " "
                char = ""
            else:
                char = char + message[count]
    else:
        Ascii = "0"
        for count in range(len(message)):
            if (count+2)%3 == 0:
                char = char + message[count]
                Ascii = Ascii + char + " "
                char = ""
            else:
                char = char + message[count]
    return Ascii

print(Num2Ascii(str(gmpy2.iroot_rem(x[0],3)[0])))

for val in Num2Ascii(str(gmpy2.iroot_rem(x[0],3)[0])).strip().split(" "):
    print(chr(int(val)), end ="")
```

---

<details><summary>FLAG:</summary>

```
WPI{Ch1n3s3_R3M@ind3R_Th30r3m_!_}
```

</details>
<br/>
